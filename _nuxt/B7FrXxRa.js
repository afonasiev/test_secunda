import{_ as R}from"./C3kXO9LS.js";import{a as Q,u as W,_ as X}from"./DBoHGy99.js";import{_ as T}from"./DlAUqK2U.js";import{c as y,o as h,a as t,x as Y,n as u,e as j,m as Z,j as ee,f as w,y as te,z as se,k as b,A as O,B as le,l as oe,C as ne,D as x,g as p,E as N,G as U,q as V,b as g,H as ae,I as k,w as $,F as B,h as ie,t as E,J as ue,d as J,i as L}from"./BFtw5I9y.js";const re="_table_e3ccg_1",de={table:re},ce={};function me(o,l){return h(),y("table",{class:u(o.$style.table)},[l[0]||(l[0]=t("thead",null,[t("tr",null,[t("th",null,"id"),t("th",null,"Check"),t("th",null,"Name"),t("th")])],-1)),t("tbody",null,[Y(o.$slots,"default")])],2)}const pe={$style:de},he=Object.assign(T(ce,[["render",me],["__cssModules",pe]]),{__name:"UiTable"}),_e=j({__name:"index",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:Z(["accept"],["update:modelValue"]),setup(o,{emit:l}){const c=ee(o,"modelValue"),f=l;return(r,n)=>{const a=Q;return h(),w(a,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=m=>c.value=m),onAccept:n[1]||(n[1]=m=>f("accept")),title:"Редактирование",text:"Сохранить внесенные изменения?"},null,8,["modelValue"])}}}),ye=Object.assign(_e,{__name:"SharedModalEdit"}),fe=te("historyStore",{state:()=>({list:[],history:[],future:[]}),actions:{resetData(){this.history=[],this.future=[],this.list=[]},setData(o){this.history.push(JSON.parse(JSON.stringify(this.list))),this.future=[],this.list=o},undo(){this.history.length&&(this.future.push(JSON.parse(JSON.stringify(this.list))),this.list=this.history.pop())},redo(){this.future.length&&(this.history.push(JSON.parse(JSON.stringify(this.list))),this.list=this.future.pop())}},getters:{getList:o=>o.list}}),ve=["onKeydown"],be=["checked","onUpdate:modelValue"],ge=j({__name:"index",props:{editData:{default:null},editProp:{type:Boolean,default:!1}},setup(o){const l=fe(),c=W(),f=se(),r=b(""),n=b(""),a=b([]),m=b(!1),S=e=>e.replace(/\s/g,""),M=()=>{if(S(n.value).length===0)return;const e=a.value[a.value.length-1],s=e!==void 0?e.id:0,d={id:a.value.length>0?s+1:0,name:n.value,check:!1};a.value.push(d),n.value=""},z=e=>{a.value=a.value.filter(s=>s.id!==e)},A=async()=>{a.value.length>0&&r.value.length>0&&(o.editProp?m.value=!m.value:await F())},F=async()=>{const e=c.notes[c.notes.length-1],s=e!==void 0?e.id:0,d={id:c.notes.length>0?s+1:0,title:r.value,list:l.list};c.newNote(d),C(),await L("/")},I=async()=>{const s={id:o.editData.id,title:r.value,list:l.list};c.updateNote(s),C(),await L("/")},C=()=>{r.value="",n.value="",a.value=[],l.resetData()},D=e=>{const _=navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey:e.ctrlKey,d=e.shiftKey,v=e.key.toLowerCase()==="z";_&&!d&&v?l.history.length&&(e.preventDefault(),l.undo()):_&&d&&v&&l.future.length&&(e.preventDefault(),l.redo())},P=O(()=>S(r.value).length>0?f.top:""),q=O(()=>S(n.value).length>0?f.top:"");return le(()=>a.value,e=>{l.setData(e)},{deep:!0}),oe(()=>{document.addEventListener("keydown",D),o.editData&&(r.value=o.editData.title,a.value=o.editData.list)}),ne(()=>{document.removeEventListener("keydown",D)}),(e,s)=>{const _=R,d=X,v=he,H=ye;return h(),y(B,null,[t("form",{class:u(e.$style.form),onSubmit:k(A,["prevent"])},[t("label",{class:u([e.$style.label,p(P)])},[N(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>V(r)?r.value=i:null),class:u(e.$style.input),required:""},null,2),[[U,p(r),void 0,{trim:!0}]]),t("span",{class:u(e.$style.placeholder)},"Введите название заметки",2)],2),t("label",{class:u([e.$style.label,p(q)])},[N(t("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>V(n)?n.value=i:null),class:u(e.$style.input),onKeydown:ae(k(M,["prevent"]),["enter"])},null,42,ve),[[U,p(n),void 0,{trim:!0}]]),t("span",{class:u(e.$style.placeholder)},"Введите название задачи",2),g(d,{class:u(e.$style.button),onClick:k(M,["stop"])},{default:$(()=>[g(_,{icon:"enter"})]),_:1},8,["class"])],2),p(l).list.length>0?(h(),w(v,{key:0},{default:$(()=>[(h(!0),y(B,null,ie(p(l).list,(i,G)=>(h(),y("tr",{key:G},[t("td",null,E(i.id),1),t("td",null,[t("label",{class:u(e.$style.checkbox)},[N(t("input",{type:"checkbox",checked:i.check,"onUpdate:modelValue":K=>i.check=K},null,8,be),[[ue,i.check]]),t("span",{class:u(e.$style.pseudo)},null,2)],2)]),t("td",null,E(i.name),1),t("td",null,[g(d,{color:"red",onClick:k(K=>z(i.id),["stop"])},{default:$(()=>[...s[3]||(s[3]=[J(" delete ",-1)])]),_:1},8,["onClick"])])]))),128))]),_:1})):x("",!0),p(l).list.length>0?(h(),y("div",{key:1,class:u(e.$style.actions)},[g(d,{type:"submit"},{default:$(()=>[...s[4]||(s[4]=[J("Сохранить",-1)])]),_:1})],2)):x("",!0)],34),o.editProp?(h(),w(H,{key:0,modelValue:p(m),"onUpdate:modelValue":s[2]||(s[2]=i=>V(m)?m.value=i:null),onAccept:I},null,8,["modelValue"])):x("",!0)],64)}}}),ke="_form_16m8y_1",$e="_label_16m8y_8",Se="_placeholder_16m8y_15",xe="_input_16m8y_29",Ne="_button_16m8y_43",Ve="_top_16m8y_56",we="_pseudo_16m8y_64",Me="_checkbox_16m8y_91",Ce={form:ke,label:$e,placeholder:Se,input:xe,button:Ne,top:Ve,pseudo:we,checkbox:Me},De={$style:Ce},Ee=Object.assign(T(ge,[["__cssModules",De]]),{__name:"SharedForm"});export{Ee as _};
